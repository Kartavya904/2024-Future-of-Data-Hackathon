@page
@model TradeModel

<div class="container">
    <h1>Paper Trading</h1>
    <p>Portfolio Value: @Model.PortfolioValue</p>
    <p>Shares Owned: @Model.SharesOwned</p>

    <form method="post">
        <input type="number" name="shares" placeholder="Number of shares" />
        <button type="submit" formaction="/Trade?handler=Buy">Buy</button>
        <button type="submit" formaction="/Trade?handler=Sell">Sell</button>
    </form>

    <canvas id="stockChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    var stockData = @Html.Raw(Model.StockData); // Handle your data appropriately

    var ctx = document.getElementById('stockChart').getContext('2d');


    var stockChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: Object.keys(stockData["Time Series (Daily)"]), // Example structure
            datasets: [{
                label: 'Stock Prices',
                data: Object.values(stockData["Time Series (Daily)"]).map(d => d["4. close"]),
                borderColor: 'rgba(75, 192, 192, 1)',
                fill: false
            }]
        },
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'Stock Price Over Time'
            },
            tooltips: {
                mode: 'index',
                intersect: false,
            },
            hover: {
                mode: 'nearest',
                intersect: true
            }
        }
    });
</script>
